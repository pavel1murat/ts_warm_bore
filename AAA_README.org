# ts_warm_bore/AAA_README.org

  *subdirectories:*

  711_0000: default geometry
  711_0001: "worst case"
  711_0002: non-round TS5 collimator hole
  711_1000: default geometry, used to generate a 5M dataset
  711_1001: "worst case"    , used to generate a 5M dataset

  711_9999: example of huge offsets

  fcl, geom - for tests, templates...

  tmp_code: stores tarballs
  tmp_fcl : stores FCL files produced with generate_fcl

* *COMMENTS*

  <2018-10-04 Thu> why Dave calls stage3 mothers bin ?

* directory: file:./

* generating a tarball: gridexport -E ../grid_export -A ts_warm_bore/AAA_GRIDEXPORT_EXCLUDE.txt
* 711_0000: default geometry

* 711_0001: "worst case" : misaligned bore geometry with perfect TS3 ends positioning

* WORK LOG
#

olddir=$PWD

generate_fcl --description=s1 --dsconf=711_0000 --events=20000 --njobs=250 --embed ts_warm_bore/711_0000/PS_711_0000.fcl --run=1
mv seeds.murat.s1.711_0000.*.txt 000/.
mv 000 /mu2e/app/users/murat/fcl/ts_warm_bore_711_0000.s1.250_20000

cd /mu2e/app/users/murat/fcl/ts_warm_bore_711_0000.s1.250_20000
tar -cjf ../ts_warm_bore_711_0000.s1.250_20000.tbz *.fcl
cd $olddir

generate_fcl --description=s1 --dsconf=711_0001 --events=20000 --njobs=250 --embed ts_warm_bore/711_0001/PS_711_0001.fcl --run=1
mv seeds.murat.s1.711_0001.*.txt 000/.
mv 000 /mu2e/app/users/murat/fcl/ts_warm_bore_711_0001.s1.250_20000

cd /mu2e/app/users/murat/fcl/ts_warm_bore_711_0001.s1.250_20000
tar -cjf ../ts_warm_bore_711_0001.s1.250_20000.tbz *.fcl
cd $olddir

generate_fcl --description=s2 --dsconf=711_1000 --merge=10 --embed ts_warm_bore/711_0000/TS_711_0000.fcl --inputs=catalogs/ts_warm_bore/711_1000/s1/ts_warm_bore.711_1000_s1.mubeam.art
mv seeds.murat.s2.711_1000.*.txt 000/.
mv 000 /mu2e/app/users/murat/fcl/ts_warm_bore_711_1000.s2
cd /mu2e/app/users/murat/fcl/ts_warm_bore_711_1000.s2
tar -cjf ../ts_warm_bore_711_1000.s2.tbz *.fcl

generate_fcl --description=s2 --dsconf=711_1001 --merge=10 --embed ts_warm_bore/711_0000/TS_711_0000.fcl --inputs=/grid/fermiapp/mu2e/users/murat/catalogs/ts_warm_bore/711_1001/s1/ts_warm_bore.711_1001_s1.mubeam.art
mv seeds.murat.s2.711_1001.*.txt 000/.
mv 000 /mu2e/app/users/murat/fcl/ts_warm_bore_711_1001.s2
cd /mu2e/app/users/murat/fcl/ts_warm_bore_711_1001.s2
tar -cjf ../ts_warm_bore_711_1001.s2.tbz *.fcl


project=ts_warm_bore
dsid=711_1000
stage=s2
mu2eprodsys --code=/pnfs/mu2e/resilient/users/murat/$project.code.tbz --fcllist=/pnfs/mu2e/resilient/users/murat/${project}_$dsid.$stage.tbz --dsconf=$project --wfproject=${project}_${dsid}_${stage} --expected-lifetime=3h




generate_fcl --description=ts_warm_bore --dsconf=711_1000_s1_mubeam --merge=1000 --embed Stntuple/test/g4s1_mubeam_stn.fcl \
             --inputs=catalogs/ts_warm_bore/711_1000/s1/ts_warm_bore.711_1000_s1.mubeam.art

generate_fcl --description=ts_warm_bore --dsconf=711_1001_s1_mubeam --merge=1000 --embed Stntuple/test/g4s1_mubeam_stn.fcl \
             --inputs=catalogs/ts_warm_bore/711_1001/s1/ts_warm_bore.711_1001_s1.mubeam.art



generate_fcl --description=s3 --dsconf=711_0001 --merge=10 --embed ts_warm_bore/711_0001/DS_711_0001.fcl --inputs=/grid/fermiapp/mu2e/users/murat/catalogs/ts_warm_bore/711_0001/s2/ts_warm_bore.711_0001_s2.mubeam
generate_fcl --description=s3 --dsconf=711_0000 --merge=10 --embed ts_warm_bore/711_0000/DS_711_0000.fcl --inputs=/grid/fermiapp/mu2e/users/murat/catalogs/ts_warm_bore/711_0000/s2/ts_warm_bore.711_0000_s2.mubeam

generate_fcl --description=s3 --dsconf=711_1000 --merge=5 --embed ts_warm_bore/711_0000/DS_711_0000.fcl --inputs=/grid/fermiapp/mu2e/users/murat/catalogs/ts_warm_bore/711_1000/s2/ts_warm_bore.711_1000_s2.mubeam.art
generate_fcl --description=s3 --dsconf=711_1001 --merge=5 --embed ts_warm_bore/711_0001/DS_711_0001.fcl --inputs=/grid/fermiapp/mu2e/users/murat/catalogs/ts_warm_bore/711_1001/s2/ts_warm_bore.711_1001_s2.mubeam.art

generate_fcl --description=ts_warm_bore --dsconf=711_1000_s3_tgtstops --merge=1000 --embed Stntuple/test/g4s3_tgtstops_stn.fcl  --inputs=catalogs/ts_warm_bore/711_1000/s3/ts_warm_bore.711_1000_s3.tgtstops.art

ts_warm_bore/scripts/gen_fcl 711_1000 s3 ootstops stn .
ts_warm_bore/scripts/gen_fcl 711_1001 s3 ootstops stn .


gridexport -E $PWD/grid_export -A ts_warm_bore/AAA_GRIDEXPORT_EXCLUDE.txt ; 
# then rename the tarball to ts_warm_bore.code_7002.tbz

ts_warm_bore/scripts/gen_fcl 711_1003 gen all s1 .
cd ts_warm_bore/tmp_fcl/711_1003.gen_all.s1/
tar -cjf ../ts_warm_bore_711_1003.s1.tbz *.fcl
cp ../ts_warm_bore_711_1003.s1.tbz /pnfs/mu2e/resilient/users/murat/.

gridexport -E $PWD/grid_export -A ts_warm_bore/AAA_GRIDEXPORT_EXCLUDE.txt
# then rename the tarball to ts_warm_bore.code_1003.tbz and copy it to /pnfs/mu2e/resilient/users/murat

mu2eprodsys --code=/pnfs/mu2e/resilient/users/murat/ts_warm_bore.code.711_1004.tbz --fcllist=/pnfs/mu2e/resilient/users/murat/ts_warm_bore.711_1004.gen_250_20000.s1.tbz --dsconf=ts_warm_bore_711_1004_gen_250_20000_s1 --wfproject=ts_warm_bore.711_1004.gen_250_20000.s1 --expected-lifetime=8h

ts_warm_bore/scripts/list_pnfs_files 711_1004 gen 250_20000 s1 mubeam 12027845 .
ts_warm_bore/scripts/copy_log_files 711_1004 gen 250_20000 s1 s1 12027845 .

cd ts_warm_bore/tmp_fcl/711_1004.s1_mubeam.s2/

tar -cjf ../ts_warm_bore.711_1004.s1_mubeam.s2.tbz *.fcl

ts_warm_bore/scripts/copy_log_files 711_1004 s1 mubeam s2 sim 12036583 .

ts_warm_bore/scripts/list_pnfs_files 711_1004 s1 mubeam s2 mubeam    12036583
ts_warm_bore/scripts/list_pnfs_files 711_1004 s1 mubeam s2 crv       12036583
ts_warm_bore/scripts/list_pnfs_files 711_1004 s1 mubeam s2 truncated 12036583

ts_warm_bore/scripts/gen_fcl 711_1004 s2 mubeam s3 s3
cp ts_warm_bore/tmp_fcl/ts_warm_bore.711_1004.s2_mubeam.s3.tbz /pnfs/mu2e/resilient/users/murat
mu2eprodsys --code=/pnfs/mu2e/resilient/users/murat/ts_warm_bore.code.711_1004.tbz --fcllist=/pnfs/mu2e/resilient/users/murat/ts_warm_bore.711_1004.s2_mubeam.s3.tbz --dsconf=ts_warm_bore_711_1004_s2_mubeam_s3 --wfproject=ts_warm_bore.711_1004.s2_mubeam.s3 --expected-lifetime=8h

ts_warm_bore/scripts/gen_fcl 711_1004 s1 mubeam s1 stn
murat/scripts/submit_mu2e_job -c ts_warm_bore/tmp_fcl/711_1004.s1_mubeam.stn/cnf.murat.ts_warm_bore.711_1004_s1_mubeam.000001_00000000.fcl
