# ts_warm_bore/AAA_README.org

  *subdirectories:*

  711_1000: default geometry, used to generate a 5M dataset
  711_1001: "worst case"    , used to generate a 5M dataset
  711_1003: non-round TS5 collimator hole
  711_1004: maximized TS1 and TS5 collimator holes, also increased radius of the pbar window
  711_1005: "mitigated" geometry: offsets compensated, only angles left
  711_1006: default beamline, new target with 3 fins
  711_1007: default beamline, old target with r=5mm
  711_1008: default beamline, magnetic field: TSu coils 14 and 15 swapped 
  711_1009: TS1 hole R = 130mm

  711_1011: default beamline, beam down by 1 mm
  711_1012: default beamline, beam down by 2 mm
  711_1013: default beamline, beam down by 3 mm
  711_1014: default beamline, beam down by 4 mm
  711_1015: default beamline, beam down by 5 mm

  *pbars*
  711_2000: run on input PBARs traced down to VDET91 , default geometry
  711_2001: run on input PBARs traced down to VDET91 , R(TS1) = 12cm
  711_2002: R(TS1coll = 12cm), no TS3 wedge
  711_2003: default geometry, a plane limiting tracing instead of a volume (just for debugging)



  see file:/mu2e/app/users/murat/tsud_bore_prof/catalogs/antiprotons_cs1VD91.170829/sim.mu2e.antiprotons_cs1VD91.170829.org

  711_9999: example of huge offsets

  fcl, geom - for tests, templates...

  tmp_code: stores tarballs
  tmp_fcl : stores FCL files produced with generate_fcl
* *------------------------------------------------------------------------------*
* directory: file:./
* *------------------------------------------------------------------------------*
* *COMMENTS*                                                              
  
  *why Dave calls stage3 mothers bin ?*

  *to store stopped mu+*: add to DS*.fcl:

  physics.producers.stoppedMuonFinder.particleTypes     : [ 13 , -13 ]   # both mu- and mu+
  physics.producers.outOfTargetMuonFinder.particleTypes : [ 13 , -13 ]   # both mu- and mu+
  
* *------------------------------------------------------------------------------*
* *file firmats* 
* *------------------------------------------------------------------------------*
** *stage2 mubeam*            
murat@mu2ebuild01:/mu2e/app/users/murat/tsud_bore_prof>mu2e -c Print/fcl/dumpDataProducts.fcl -s results/2019-09-27-12-31.TS_711_2000.mu2egpvm06.23149/sim.owner.TS-mubeam.version.sequencer.art 
29-Sep-2019 10:40:06 CDT  Initiating request to open input file "results/2019-09-27-12-31.TS_711_2000.mu2egpvm06.23149/sim.owner.TS-mubeam.version.sequencer.art"
29-Sep-2019 10:40:07 CDT  Opened input file "results/2019-09-27-12-31.TS_711_2000.mu2egpvm06.23149/sim.owner.TS-mubeam.version.sequencer.art"
Begin processing the 1st record. run: 1000 subRun: 751 event: 17796 at 29-Sep-2019 10:40:08 CDT
Found 6 data products in this Event
Data products: 
Friendly Class Name    Module Label    Instance Name         Process Name     Product ID
mu2e::SimParticlemv  muonBeamFilter                                    TS  1000137853
 mu2e::GenParticles        generate                   antiprotonsg4s1VD91  1510753068
 mu2e::StepPointMCs  muonBeamFilter         DSVacuum                   TS  1804935316
 mu2e::StepPointMCs  muonBeamFilter  virtualdetector                   TS  2681977965
     mu2e::StatusG4           g4run                   antiprotonsg4s1VD91  3795004908
     mu2e::StatusG4           g4run                                    TS  4205842999

Found 2 data products in this SubRun
Data products: 
                     Friendly Class Name        Module Label  Instance Name         Process Name     Product ID
uintmu2e::PhysicalVolumeInfomvstd::pairs  compressPVmuonBeam                                  TS  1912427908
                     mu2e::GenEventCount          genCounter                 antiprotonsg4s1VD91  2666321646

Found 0 data products in this Run
29-Sep-2019 10:40:08 CDT  Closed input file "results/2019-09-27-12-31.TS_711_2000.mu2egpvm06.23149/sim.owner.TS-mubeam.version.sequencer.art"
Art has completed and will exit with status 0.
** *stage2 truncated*         
murat@mu2ebuild01:/mu2e/app/users/murat/tsud_bore_prof>mu2e -c Print/fcl/dumpDataProducts.fcl -s results/2019-09-27-12-31.TS_711_2000.mu2egpvm06.23149/sim.owner.TS-truncated.version.sequencer.art
29-Sep-2019 10:43:40 CDT  Initiating request to open input file "results/2019-09-27-12-31.TS_711_2000.mu2egpvm06.23149/sim.owner.TS-truncated.version.sequencer.art"
29-Sep-2019 10:43:41 CDT  Opened input file "results/2019-09-27-12-31.TS_711_2000.mu2egpvm06.23149/sim.owner.TS-truncated.version.sequencer.art"
Begin processing the 1st record. run: 1000 subRun: 751 event: 19917 at 29-Sep-2019 10:43:42 CDT
Found 7 data products in this Event
Data products: 
Friendly Class Name  Module Label    Instance Name         Process Name     Product ID
 mu2e::StepPointMCs         g4run  virtualdetector                   TS   475983712
 mu2e::StepPointMCs         g4run              CRV                   TS   860891107
mu2e::SimParticlemv         g4run                                    TS  1328224906
 mu2e::GenParticles      generate                   antiprotonsg4s1VD91  1510753068
 mu2e::StepPointMCs         g4run         DSVacuum                   TS  3465821392
     mu2e::StatusG4         g4run                   antiprotonsg4s1VD91  3795004908
     mu2e::StatusG4         g4run                                    TS  4205842999

Found 2 data products in this SubRun
Data products: 
                     Friendly Class Name    Module Label  Instance Name         Process Name     Product ID
uintmu2e::PhysicalVolumeInfomvstd::pairs  compressPVFull                                  TS    59512762
                     mu2e::GenEventCount      genCounter                 antiprotonsg4s1VD91  2666321646

Found 0 data products in this Run
29-Sep-2019 10:43:42 CDT  Closed input file "results/2019-09-27-12-31.TS_711_2000.mu2egpvm06.23149/sim.owner.TS-truncated.version.sequencer.art"
Art has completed and will exit with status 0.
* <2019-06-23 Sun> last tarball in tmp_code was called:  ts_warm_bore.code.711_1025.tbz, delete it to save space
* generating a tarball: gridexport -E ../grid_export -A ts_warm_bore/AAA_GRIDEXPORT_EXCLUDE.txt
* 711_0000: default geometry
* 711_0001: "worst case" : misaligned bore geometry with perfect TS3 ends positioning
* *------------------------------------------------------------------------------*
* *WORK LOG*                                                                 
  <2019-09-30 Mon>

  murat/scripts/submit_mu2e_job -c ts_warm_bore/711_2001/TS_711_2001.fcl \
  -s /pnfs/mu2e/tape/phy-sim/sim/mu2e/antiprotons_cs1VD91/170829/art/5c/b6/sim.mu2e.antiprotons_cs1VD91.170829.001000_00000751.art \
  -o /mu2e/data/users/murat/datasets/ts_warm_bore/711_2001

  murat/scripts/submit_mu2e_job -c ts_warm_bore/711_2000/TS_711_2000.fcl \
  -s /pnfs/mu2e/tape/phy-sim/sim/mu2e/antiprotons_cs1VD91/170829/art/5c/b6/sim.mu2e.antiprotons_cs1VD91.170829.001000_00000751.art \
  -o /mu2e/data/users/murat/datasets/ts_warm_bore/711_2000

  *711_3001 with mubeamFilter::TS3CEnter*
root [5] m_spmc->fSimpBlock->Print(); m_spmc->fStepPointMCBlock->Print()
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
   i name                   PDG     ID GenID  ParentID    p0x       p0y       p0z       p0       v0x        v0y      v0z         t0       p1x       p1y        p1z      p1       v1x        v1y       v1z        t1
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
   0 proton                2212      1    16      -1 -2150.417     0.000 -8624.851  8888.889  3924.193    -0.037 -6087.086     0.000    -0.000    -0.000    -0.000     0.000  3923.140    -0.037 -6091.309     0.015
   1 pi0                    111      3    16       1 -1412.293     2.676 -1559.496  2103.950  3923.140    -0.037 -6091.309     0.015 -1412.293     2.676 -1559.496  2103.950  3923.140    -0.037 -6091.309     0.015
   2 gamma                   22   3485    -1       3 -1284.476    -4.706 -1469.661  1951.872  3923.140    -0.037 -6091.309     0.015    -0.000    -0.000    -0.000     0.000  3922.409    -0.040 -6092.146     0.018
   3 e+                     -11   6477    -1    3485 -1233.209    -3.901 -1412.416  1875.030  3922.409    -0.040 -6092.146     0.018     0.000    -0.000    -0.000     0.000  2551.250   886.042-16403.186    36.485
   4 gamma                   22   6488    -1    6477    -9.173     0.180   -10.411    13.876  3920.875    -0.072 -6093.868     0.026    -0.000    -0.000     0.000     0.000  3919.584    -0.875 -6095.099     0.035
   5 e-                      11   7546    -1    6488    -9.117     0.644   -10.479    13.905  3919.683    -0.049 -6095.221     0.032    -2.580     2.699     2.274     4.371   963.027     8.917     4.609    47.682
   6 e-                      11 100001    -1    7546    -2.791    -1.953    -2.740     4.371   975.000    15.582    -2.096    47.614    -2.870    -2.537    -1.973     4.309    -0.082    15.812    11.762    52.723
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
   Vol   Gen     PDG Particle          Creation   SimID   PPdg  PSimID  StopProc     X          Y          Z     Edep(Tot) Edep(NIO)  Step    Time      Px        Py        Pz
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
    0      -1     11 e-                      56  100001     11    7546      49      0.083     15.965     11.862  0.06241  0.00000    0.247   52.723   -2.926   -2.447   -2.136


  *711_3001 used mubeamFilter:DSVacuum* : *no StepPointMC's in DSVacuum, electron tracing stops at X=0*
root [2] m_spmc->fSimpBlock->Print(); m_spmc->fStepPointMCBlock->Print()
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
   i name                   PDG     ID GenID  ParentID    p0x       p0y       p0z       p0       v0x        v0y      v0z         t0       p1x       p1y        p1z      p1       v1x        v1y       v1z        t1
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
   0 proton                2212      1    16      -1 -2150.417     0.000 -8624.851  8888.889  3924.193    -0.037 -6087.086     0.000    -0.000    -0.000    -0.000     0.000  3923.140    -0.037 -6091.309     0.015
   1 pi0                    111      3    16       1 -1412.293     2.676 -1559.496  2103.950  3923.140    -0.037 -6091.309     0.015 -1412.293     2.676 -1559.496  2103.950  3923.140    -0.037 -6091.309     0.015
   2 gamma                   22   3485    -1       3 -1284.476    -4.706 -1469.661  1951.872  3923.140    -0.037 -6091.309     0.015    -0.000    -0.000    -0.000     0.000  3922.409    -0.040 -6092.146     0.018
   3 e+                     -11   6477    -1    3485 -1233.209    -3.901 -1412.416  1875.030  3922.409    -0.040 -6092.146     0.018     0.000    -0.000    -0.000     0.000  2551.250   886.042-16403.186    36.485
   4 gamma                   22   6488    -1    6477    -9.173     0.180   -10.411    13.876  3920.875    -0.072 -6093.868     0.026    -0.000    -0.000     0.000     0.000  3919.584    -0.875 -6095.099     0.035
   5 e-                      11   7546    -1    6488    -9.117     0.644   -10.479    13.905  3919.683    -0.049 -6095.221     0.032    -2.580     2.699     2.274     4.371   963.027     8.917     4.609    47.682
   6 e-                      11 100001    -1    7546    -2.791    -1.953    -2.740     4.371   975.000    15.582    -2.096    47.614    -2.870    -2.537    -1.973     4.309    -0.082    15.812    11.762    52.723


  *711_3000 default tracing* 
root [5] g.x->ProcessEntry(0)
root [6] m_spmc->fSimpBlock->Print(); m_spmc->fStepPointMCBlock->Print()
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
   i name                   PDG     ID GenID  ParentID    p0x       p0y       p0z       p0       v0x        v0y      v0z         t0       p1x       p1y        p1z      p1       v1x        v1y       v1z        t1
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
   0 proton                2212      1    16      -1 -2150.417     0.000 -8624.851  8888.889  3924.193    -0.037 -6087.086     0.000    -0.000    -0.000    -0.000     0.000  3923.140    -0.037 -6091.309     0.015
   1 pi0                    111      3    16       1 -1412.293     2.676 -1559.496  2103.950  3923.140    -0.037 -6091.309     0.015 -1412.293     2.676 -1559.496  2103.950  3923.140    -0.037 -6091.309     0.015
   2 gamma                   22   3485    -1       3 -1284.476    -4.706 -1469.661  1951.872  3923.140    -0.037 -6091.309     0.015    -0.000    -0.000    -0.000     0.000  3922.409    -0.040 -6092.146     0.018
   3 e+                     -11   6477    -1    3485 -1233.209    -3.901 -1412.416  1875.030  3922.409    -0.040 -6092.146     0.018     0.000    -0.000    -0.000     0.000  2551.250   886.042-16403.186    36.485
   4 gamma                   22   6488    -1    6477    -9.173     0.180   -10.411    13.876  3920.875    -0.072 -6093.868     0.026    -0.000    -0.000     0.000     0.000  3919.584    -0.875 -6095.099     0.035
   5 e-                      11   7546    -1    6488    -9.117     0.644   -10.479    13.905  3919.683    -0.049 -6095.221     0.032    -2.580     2.699     2.274     4.371   963.027     8.917     4.609    47.682
   6 e-                      11 100001    -1    7546    -2.791    -1.953    -2.740     4.371   975.000    15.582    -2.096    47.614    -2.686     1.912     2.773     4.309 -3878.221     5.950  2930.000    80.132
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
   Vol   Gen     PDG Particle          Creation   SimID   PPdg  PSimID  StopProc     X          Y          Z     Edep(Tot) Edep(NIO)  Step    Time      Px        Py        Pz
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
    0      -1     11 e-                      56  100001     11    7546      49  -3877.327      5.180   2929.000  0.00000  0.00000    1.550   80.127   -2.162    2.469    2.792


  <2019-09-28 Sat> : ntupling - use the final output directory:

  murat/scripts/submit_mu2e_job -c ts_warm_bore/tmp_fcl/711_1030.s2_mubeam.s3_stn/cnf.murat.ts_warm_bore.711_1030_s2_mubeam_s3_stn.000001_00000000.fcl \
                                -o /mu2e/data/users/murat/datasets/ts_warm_bore/711_1030/s2/mubeam_stn

  <2019-09-24 Tue>
  
  gridexport -E $PWD/grid_export -A ts_warm_bore/AAA_GRIDEXPORT_EXCLUDE.txt
  ts_warm_bore/scripts/gen_fcl ts_warm_bore 711_1010 gen 250_20000 s1 sim .
  ts_warm_bore/scripts/submit_grid_job ts_warm_bore 711_1010 gen 250_20000 s1 sim .

  <2019-09-22 Sun>

  ts_warm_bore/scripts/list_pnfs_files 711_1009 s2 mubeam s3 sim tgtstop 23548622 .
  ts_warm_bore/scripts/list_pnfs_files 711_1009 s2 mubeam s3 sim ootstop 23548622 .
  ts_warm_bore/scripts/list_pnfs_files 711_1009 s2 mubeam s3 sim crv 23548622 .
  ts_warm_bore/scripts/list_pnfs_files 711_1009 s2 mubeam s3 sim truncated 23548622 .
  ts_warm_bore/scripts/list_pnfs_files 711_1009 s2 mubeam s3 sim mothers 23548622 .
  ts_warm_bore/scripts/list_pnfs_files 711_1009 s2 mubeam s3 sim beam 23548622 .


  <2019-09-17 Tue> 

  ts_warm_bore/scripts/gen_fcl ts_warm_bore 711_1009 s1 mubeam s2 sim .
  ts_warm_bore/scripts/submit_grid_job ts_warm_bore 711_1009 s1 mubeam s2 sim .
  ts_warm_bore/scripts/gen_fcl ts_warm_bore 711_1009 s1 mubeam s2 stn .
  
  

  <2019-09-15 Sun>

  setup gridexport
  gridexport -E $PWD/grid_export -A ts_warm_bore/AAA_GRIDEXPORT_EXCLUDE.txt

  ts_warm_bore/scripts/gen_fcl ts_warm_bore 711_1009 gen 2_200 s1 sim .
  ts_warm_bore/scripts/submit_grid_job ts_warm_bore 711_1009 gen 250_20000 s1 sim .

  <2019-09-14 Sat>

  ts_warm_bore/scripts/gen_fcl ts_warm_bore 711_1009 gen 250_20000 s1 sim .
  murat/scripts/submit_mu2e_job -c ts_warm_bore/tmp_fcl/711_1009.gen_250_20000.s1_sim/cnf.murat.ts_warm_bore.711_1009_gen_250_20000_s1_sim.000001_00000000.fcl -n 1000 &

  <2019-08-24 Sat> 

generate_fcl --description=s1 --dsconf=711_1008 --events=20000 --njobs=250 --embed ts_warm_bore/711_1008/PS_711_1008.fcl --run=1



 <2019-03-16 Sat>

 pnfs_scratch=/pnfs/mu2e/scratch/users/murat/workflow;
 od=/grid/fermiapp/mu2e/users/murat/catalogs/ts_warm_bore

 ls $pnfs_scratch/ts_warm_bore.711_1021.s2_mubeam.s3/outstage/17198986/00/*/*.art | grep DS-TGTstops >| $od/711_1021/s3/ts_warm_bore.711_1021_s3.tgtstops.art
 ls $pnfs_scratch/ts_warm_bore.711_1011.s2_mubeam.s3/outstage/17040813/00/*/*.art | grep DS-TGTstops >| $od/711_1011/s3/ts_warm_bore.711_1011_s3.tgtstops.art
 ts_warm_bore/scripts/copy_log_files 711_1011 s2 mubeam s3 sim 17040813  
 ls $pnfs_scratch/ts_warm_bore.711_1012.s2_mubeam.s3/outstage/17039568/00/*/*.art | grep DS-TGTstops >| $od/711_1012/s3/ts_warm_bore.711_1012_s3.tgtstops.art
 ls $pnfs_scratch/ts_warm_bore.711_1013.s2_mubeam.s3/outstage/17039568/00/*/*.art | grep DS-TGTstops >| $od/711_1013/s3/ts_warm_bore.711_1013_s3.tgtstops.art
 ls $pnfs_scratch/ts_warm_bore.711_1013.s2_mubeam.s3/outstage/17039491/00/*/*.art | grep DS-TGTstops >| $od/711_1013/s3/ts_warm_bore.711_1013_s3.tgtstops.art
 ls $pnfs_scratch/ts_warm_bore.711_1014.s2_mubeam.s3/outstage/17040933/00/*/*.art | grep DS-TGTstops >| $od/711_1014/s3/ts_warm_bore.711_1014_s3.tgtstops.art
 ls $pnfs_scratch/ts_warm_bore.711_1015.s2_mubeam.s3/outstage/17056270/00/*/*.art | grep DS-TGTstops >| $od/711_1015/s3/ts_warm_bore.711_1015_s3.tgtstops.art
 ls $pnfs_scratch/ts_warm_bore.711_1021.s2_mubeam.s3/outstage/17198986/00/*/*.art | grep DS-TGTstops >| $od/711_1021/s3/ts_warm_bore.711_1021_s3.tgtstops.art
 ls $pnfs_scratch/ts_warm_bore.711_1022.s2_mubeam.s3/outstage/17039439/00/*/*.art | grep DS-TGTstops >| $od/711_1022/s3/ts_warm_bore.711_1022_s3.tgtstops.art
 ls $pnfs_scratch/ts_warm_bore.711_1023.s2_mubeam.s3/outstage/17085512/00/*/*.art | grep DS-TGTstops >| $od/711_1023/s3/ts_warm_bore.711_1023_s3.tgtstops.art
 ls $pnfs_scratch/ts_warm_bore.711_1024.s2_mubeam.s3/outstage/17056405/00/*/*.art | grep DS-TGTstops >| $od/711_1024/s3/ts_warm_bore.711_1024_s3.tgtstops.art
 ls $pnfs_scratch/ts_warm_bore.711_1025.s2_mubeam.s3/outstage/17056321/00/*/*.art | grep DS-TGTstops >| $od/711_1025/s3/ts_warm_bore.711_1025_s3.tgtstops.art

 ts_warm_bore/scripts/gen_fcl ts_warm_bore 711_1011 s3 tgtstops s3 stn .
 ts_warm_bore/scripts/gen_fcl ts_warm_bore 711_1012 s3 tgtstops s3 stn .
 ts_warm_bore/scripts/gen_fcl ts_warm_bore 711_1013 s3 tgtstops s3 stn .
 ts_warm_bore/scripts/gen_fcl ts_warm_bore 711_1014 s3 tgtstops s3 stn .
 ts_warm_bore/scripts/gen_fcl ts_warm_bore 711_1015 s3 tgtstops s3 stn .
 ts_warm_bore/scripts/gen_fcl ts_warm_bore 711_1021 s3 tgtstops s3 stn .
 ts_warm_bore/scripts/gen_fcl ts_warm_bore 711_1022 s3 tgtstops s3 stn .
 ts_warm_bore/scripts/gen_fcl ts_warm_bore 711_1023 s3 tgtstops s3 stn .
 ts_warm_bore/scripts/gen_fcl ts_warm_bore 711_1024 s3 tgtstops s3 stn .
 ts_warm_bore/scripts/gen_fcl ts_warm_bore 711_1025 s3 tgtstops s3 stn .

 dsid=711_1011; murat/scripts/submit_mu2e_job -c ts_warm_bore/tmp_fcl/$dsid.s3_tgtstops.stn/cnf.murat.ts_warm_bore.${dsid}_s3_tgtstops_stn.000001_00000000.fcl -o /mu2e/data/users/murat/datasets/ts_warm_bore/$dsid/s3/tgtstops_stn &
 dsid=711_1012; murat/scripts/submit_mu2e_job -c ts_warm_bore/tmp_fcl/$dsid.s3_tgtstops.stn/cnf.murat.ts_warm_bore.${dsid}_s3_tgtstops_stn.000001_00000000.fcl -o /mu2e/data/users/murat/datasets/ts_warm_bore/$dsid/s3/tgtstops_stn &
 dsid=711_1013; murat/scripts/submit_mu2e_job -c ts_warm_bore/tmp_fcl/$dsid.s3_tgtstops.stn/cnf.murat.ts_warm_bore.${dsid}_s3_tgtstops_stn.000001_00000000.fcl -o /mu2e/data/users/murat/datasets/ts_warm_bore/$dsid/s3/tgtstops_stn &
 dsid=711_1014; murat/scripts/submit_mu2e_job -c ts_warm_bore/tmp_fcl/$dsid.s3_tgtstops.stn/cnf.murat.ts_warm_bore.${dsid}_s3_tgtstops_stn.000001_00000000.fcl -o /mu2e/data/users/murat/datasets/ts_warm_bore/$dsid/s3/tgtstops_stn &
 dsid=711_1015; murat/scripts/submit_mu2e_job -c ts_warm_bore/tmp_fcl/$dsid.s3_tgtstops.stn/cnf.murat.ts_warm_bore.${dsid}_s3_tgtstops_stn.000001_00000000.fcl -o /mu2e/data/users/murat/datasets/ts_warm_bore/$dsid/s3/tgtstops_stn &
 dsid=711_1021; murat/scripts/submit_mu2e_job -c ts_warm_bore/tmp_fcl/$dsid.s3_tgtstops.stn/cnf.murat.ts_warm_bore.${dsid}_s3_tgtstops_stn.000001_00000000.fcl -o /mu2e/data/users/murat/datasets/ts_warm_bore/$dsid/s3/tgtstops_stn &
 dsid=711_1022; murat/scripts/submit_mu2e_job -c ts_warm_bore/tmp_fcl/$dsid.s3_tgtstops.stn/cnf.murat.ts_warm_bore.${dsid}_s3_tgtstops_stn.000001_00000000.fcl -o /mu2e/data/users/murat/datasets/ts_warm_bore/$dsid/s3/tgtstops_stn &
 dsid=711_1023; murat/scripts/submit_mu2e_job -c ts_warm_bore/tmp_fcl/$dsid.s3_tgtstops.stn/cnf.murat.ts_warm_bore.${dsid}_s3_tgtstops_stn.000001_00000000.fcl -o /mu2e/data/users/murat/datasets/ts_warm_bore/$dsid/s3/tgtstops_stn &
 dsid=711_1024; murat/scripts/submit_mu2e_job -c ts_warm_bore/tmp_fcl/$dsid.s3_tgtstops.stn/cnf.murat.ts_warm_bore.${dsid}_s3_tgtstops_stn.000001_00000000.fcl -o /mu2e/data/users/murat/datasets/ts_warm_bore/$dsid/s3/tgtstops_stn &
 dsid=711_1025; murat/scripts/submit_mu2e_job -c ts_warm_bore/tmp_fcl/$dsid.s3_tgtstops.stn/cnf.murat.ts_warm_bore.${dsid}_s3_tgtstops_stn.000001_00000000.fcl -o /mu2e/data/users/murat/datasets/ts_warm_bore/$dsid/s3/tgtstops_stn &

 ts_warm_bore/scripts/gen_fcl ts_warm_bore 711_1011 s1 mubeam s1 stn .
 ts_warm_bore/scripts/gen_fcl ts_warm_bore 711_1012 s1 mubeam s1 stn .
 ts_warm_bore/scripts/gen_fcl ts_warm_bore 711_1013 s1 mubeam s1 stn .
 ts_warm_bore/scripts/gen_fcl ts_warm_bore 711_1014 s1 mubeam s1 stn .
 ts_warm_bore/scripts/gen_fcl ts_warm_bore 711_1015 s1 mubeam s1 stn .
 ts_warm_bore/scripts/gen_fcl ts_warm_bore 711_1021 s1 mubeam s1 stn .
 ts_warm_bore/scripts/gen_fcl ts_warm_bore 711_1022 s1 mubeam s1 stn .
 ts_warm_bore/scripts/gen_fcl ts_warm_bore 711_1023 s1 mubeam s1 stn .
 ts_warm_bore/scripts/gen_fcl ts_warm_bore 711_1024 s1 mubeam s1 stn .
 ts_warm_bore/scripts/gen_fcl ts_warm_bore 711_1025 s1 mubeam s1 stn .

 dsid=711_1011; murat/scripts/submit_mu2e_job -c ts_warm_bore/tmp_fcl/$dsid.s1_mubeam.stn/cnf.murat.ts_warm_bore.${dsid}_s1_mubeam_stn.000001_00000000.fcl -o /mu2e/data/users/murat/datasets/ts_warm_bore/$dsid/s1/mubeam_stn &
 dsid=711_1012; murat/scripts/submit_mu2e_job -c ts_warm_bore/tmp_fcl/$dsid.s1_mubeam.stn/cnf.murat.ts_warm_bore.${dsid}_s1_mubeam_stn.000001_00000000.fcl -o /mu2e/data/users/murat/datasets/ts_warm_bore/$dsid/s1/mubeam_stn &
 dsid=711_1013; murat/scripts/submit_mu2e_job -c ts_warm_bore/tmp_fcl/$dsid.s1_mubeam.stn/cnf.murat.ts_warm_bore.${dsid}_s1_mubeam_stn.000001_00000000.fcl -o /mu2e/data/users/murat/datasets/ts_warm_bore/$dsid/s1/mubeam_stn &
 dsid=711_1014; murat/scripts/submit_mu2e_job -c ts_warm_bore/tmp_fcl/$dsid.s1_mubeam.stn/cnf.murat.ts_warm_bore.${dsid}_s1_mubeam_stn.000001_00000000.fcl -o /mu2e/data/users/murat/datasets/ts_warm_bore/$dsid/s1/mubeam_stn &
 dsid=711_1015; murat/scripts/submit_mu2e_job -c ts_warm_bore/tmp_fcl/$dsid.s1_mubeam.stn/cnf.murat.ts_warm_bore.${dsid}_s1_mubeam_stn.000001_00000000.fcl -o /mu2e/data/users/murat/datasets/ts_warm_bore/$dsid/s1/mubeam_stn &

 stnana("file","/mu2e/data/users/murat/datasets/ts_warm_bore/711_1014/s2/mubeam_stn/nts.USER.PROJECT.g4s2_mubeam.000001.stn","","",
 "spmc_ana(2)/save=ts_warm_bore.711_1014_s2_mubeam_stn.spmc_ana.hist")

 <2019-03-14 Thu>

 1. *17039491 : rerunning locally section 0*: ts_warm_bore.711_1013.s2_mubeam.s3/outstage/17039491/00/00000 


 <2019-03-13 Wed>

 *DSID=1012*

 ts_warm_bore/scripts/check_output ts_warm_bore.711_1012.gen_250_20000.s1 17161220
 ls /pnfs/mu2e/scratch/users/murat/workflow/ts_warm_bore.711_1012.gen_250_20000.s1/outstage/17161220/00/*/*.art | grep mubeam | grep -v json
 ts_warm_bore/scripts/copy_log_files 711_1012 gen 250_20000 s1 sim 17161220 .

 *after that, go to  file:/grid/fermiapp/mu2e/users/murat/catalogs/ts_warm_bore/ and do what's needed* 

 ts_warm_bore/scripts/gen_fcl ts_warm_bore 711_1012 s1 mubeam  s2 sim .

 *validation* 
 murat/scripts/submit_mu2e_job -c ts_warm_bore/tmp_fcl/711_1012.s1_mubeam.sim/cnf.murat.ts_warm_bore.711_1012_s1_mubeam_sim.000001_00000000.fcl -n 500 &

 *submit* 

 *DSID=1011: handle output of stage 1 and submit stage 2 simulation*

 murat/scripts/check_grid_output ts_warm_bore.711_1011.gen_250_20000.s1 17161389
 ts_warm_bore/scripts/copy_log_files 711_1011 gen 250_20000 s1 sim      17161389 .
 ls /pnfs/mu2e/scratch/users/murat/workflow/ts_warm_bore.711_1011.gen_250_20000.s1/outstage/17161389/00/*/*.art | grep mubeam | grep -v json  \
 >| /grid/fermiapp/mu2e/users/murat/catalogs/ts_warm_bore/711_1011/s1/ts_warm_bore.711_1011_s1.mubeam.art
 ts_warm_bore/scripts/gen_fcl ts_warm_bore 711_1011 s1 mubeam  s2 sim .
 ts_warm_bore/scripts/submit_grid_job ts_warm_bore 711_1011 s1 mubeam s2 sim .

 *DSID=1021: handle output of stage 1 and submit stage 2 simulation*
 murat/scripts/check_grid_output     ts_warm_bore.711_1021.gen_250_20000.s1 17162101
 ts_warm_bore/scripts/copy_log_files              711_1021 gen 250_20000 s1 sim      17162101 .
 ls /pnfs/mu2e/scratch/users/murat/workflow/ts_warm_bore.711_1021.gen_250_20000.s1/outstage/17162101/00/*/*.art | grep mubeam | grep -v json \
 >|  /grid/fermiapp/mu2e/users/murat/catalogs/ts_warm_bore/711_1021/s1/ts_warm_bore.711_1021_s1.mubeam.art
 ts_warm_bore/scripts/gen_fcl ts_warm_bore 711_1021 s1 mubeam  s2 sim .
 ts_warm_bore/scripts/submit_grid_job ts_warm_bore 711_1021 s1 mubeam s2 sim .

 *DSID=1022: handle output of stage 1 and submit stage 2 simulation*
 dsid=711_1022
 jobid=17162102
 murat/scripts/check_grid_output     ts_warm_bore.$dsid.gen_250_20000.s1 $jobid >| \
 /grid/fermiapp/mu2e/users/murat/catalogs/ts_warm_bore/$dsid/s1/ts_warm_bore.711_${dsid}_s1.check_grid_output.log
 ts_warm_bore/scripts/copy_log_files              $dsid gen 250_20000 s1 sim      $jobid  .
 ls /pnfs/mu2e/scratch/users/murat/workflow/ts_warm_bore.$dsid.gen_250_20000.s1/outstage/$jobid/00/*/*.art | grep mubeam | grep -v json \
 >| /grid/fermiapp/mu2e/users/murat/catalogs/ts_warm_bore/$dsid/s1/ts_warm_bore.${dsid}_s1.mubeam.art
 ts_warm_bore/scripts/gen_fcl         ts_warm_bore $dsid s1 mubeam s2 sim .
 ts_warm_bore/scripts/submit_grid_job ts_warm_bore $dsid s1 mubeam s2 sim .

 
 *DSID=1024* source ts_warm_bore/scripts/from_s1_to_s2 ts_warm_bore 711_1024 17162107
 *DSID=1025* source ts_warm_bore/scripts/from_s1_to_s2 ts_warm_bore 711_1025 17162108


 <2019-03-12 Tue> 
 setup gridexport
 gridexport -E $PWD/grid_export -A ts_warm_bore/AAA_GRIDEXPORT_EXCLUDE.txt
 

#--------------------------------------------------------------------------------------------
olddir=$PWD

generate_fcl --description=s1 --dsconf=711_0000 --events=20000 --njobs=250 --embed ts_warm_bore/711_0000/PS_711_0000.fcl --run=1
mv seeds.murat.s1.711_0000.*.txt 000/.
mv 000 /mu2e/app/users/murat/fcl/ts_warm_bore_711_0000.s1.250_20000

cd /mu2e/app/users/murat/fcl/ts_warm_bore_711_0000.s1.250_20000
tar -cjf ../ts_warm_bore_711_0000.s1.250_20000.tbz *.fcl
cd $olddir

generate_fcl --description=s1 --dsconf=711_0001 --events=20000 --njobs=250 --embed ts_warm_bore/711_0001/PS_711_0001.fcl --run=1
mv seeds.murat.s1.711_0001.*.txt 000/.
mv 000 /mu2e/app/users/murat/fcl/ts_warm_bore_711_0001.s1.250_20000

cd /mu2e/app/users/murat/fcl/ts_warm_bore_711_0001.s1.250_20000
tar -cjf ../ts_warm_bore_711_0001.s1.250_20000.tbz *.fcl
cd $olddir

generate_fcl --description=s2 --dsconf=711_1000 --merge=10 --embed ts_warm_bore/711_0000/TS_711_0000.fcl --inputs=catalogs/ts_warm_bore/711_1000/s1/ts_warm_bore.711_1000_s1.mubeam.art
mv seeds.murat.s2.711_1000.*.txt 000/.
mv 000 /mu2e/app/users/murat/fcl/ts_warm_bore_711_1000.s2
cd /mu2e/app/users/murat/fcl/ts_warm_bore_711_1000.s2
tar -cjf ../ts_warm_bore_711_1000.s2.tbz *.fcl

generate_fcl --description=s2 --dsconf=711_1001 --merge=10 --embed ts_warm_bore/711_0000/TS_711_0000.fcl --inputs=/grid/fermiapp/mu2e/users/murat/catalogs/ts_warm_bore/711_1001/s1/ts_warm_bore.711_1001_s1.mubeam.art
mv seeds.murat.s2.711_1001.*.txt 000/.
mv 000 /mu2e/app/users/murat/fcl/ts_warm_bore_711_1001.s2
cd /mu2e/app/users/murat/fcl/ts_warm_bore_711_1001.s2
tar -cjf ../ts_warm_bore_711_1001.s2.tbz *.fcl


project=ts_warm_bore
dsid=711_1000
stage=s2
mu2eprodsys --code=/pnfs/mu2e/resilient/users/murat/$project.code.tbz --fcllist=/pnfs/mu2e/resilient/users/murat/${project}_$dsid.$stage.tbz --dsconf=$project --wfproject=${project}_${dsid}_${stage} --expected-lifetime=3h




generate_fcl --description=ts_warm_bore --dsconf=711_1000_s1_mubeam --merge=1000 --embed Stntuple/test/g4s1_mubeam_stn.fcl \
             --inputs=catalogs/ts_warm_bore/711_1000/s1/ts_warm_bore.711_1000_s1.mubeam.art

generate_fcl --description=ts_warm_bore --dsconf=711_1001_s1_mubeam --merge=1000 --embed Stntuple/test/g4s1_mubeam_stn.fcl \
             --inputs=catalogs/ts_warm_bore/711_1001/s1/ts_warm_bore.711_1001_s1.mubeam.art



generate_fcl --description=s3 --dsconf=711_0001 --merge=10 --embed ts_warm_bore/711_0001/DS_711_0001.fcl --inputs=/grid/fermiapp/mu2e/users/murat/catalogs/ts_warm_bore/711_0001/s2/ts_warm_bore.711_0001_s2.mubeam
generate_fcl --description=s3 --dsconf=711_0000 --merge=10 --embed ts_warm_bore/711_0000/DS_711_0000.fcl --inputs=/grid/fermiapp/mu2e/users/murat/catalogs/ts_warm_bore/711_0000/s2/ts_warm_bore.711_0000_s2.mubeam

generate_fcl --description=s3 --dsconf=711_1000 --merge=5 --embed ts_warm_bore/711_0000/DS_711_0000.fcl --inputs=/grid/fermiapp/mu2e/users/murat/catalogs/ts_warm_bore/711_1000/s2/ts_warm_bore.711_1000_s2.mubeam.art
generate_fcl --description=s3 --dsconf=711_1001 --merge=5 --embed ts_warm_bore/711_0001/DS_711_0001.fcl --inputs=/grid/fermiapp/mu2e/users/murat/catalogs/ts_warm_bore/711_1001/s2/ts_warm_bore.711_1001_s2.mubeam.art

generate_fcl --description=ts_warm_bore --dsconf=711_1000_s3_tgtstops --merge=1000 --embed Stntuple/test/g4s3_tgtstops_stn.fcl  --inputs=catalogs/ts_warm_bore/711_1000/s3/ts_warm_bore.711_1000_s3.tgtstops.art

ts_warm_bore/scripts/gen_fcl 711_1000 s3 ootstops stn .
ts_warm_bore/scripts/gen_fcl 711_1001 s3 ootstops stn .


gridexport -E $PWD/grid_export -A ts_warm_bore/AAA_GRIDEXPORT_EXCLUDE.txt ; 
# then rename the tarball to ts_warm_bore.code_7002.tbz

ts_warm_bore/scripts/gen_fcl 711_1003 gen all s1 .
cd ts_warm_bore/tmp_fcl/711_1003.gen_all.s1/
tar -cjf ../ts_warm_bore_711_1003.s1.tbz *.fcl
cp ../ts_warm_bore_711_1003.s1.tbz /pnfs/mu2e/resilient/users/murat/.

gridexport -E $PWD/grid_export -A ts_warm_bore/AAA_GRIDEXPORT_EXCLUDE.txt
# then rename the tarball to ts_warm_bore.code_1003.tbz and copy it to /pnfs/mu2e/resilient/users/murat

mu2eprodsys --code=/pnfs/mu2e/resilient/users/murat/ts_warm_bore.code.711_1004.tbz --fcllist=/pnfs/mu2e/resilient/users/murat/ts_warm_bore.711_1004.gen_250_20000.s1.tbz --dsconf=ts_warm_bore_711_1004_gen_250_20000_s1 --wfproject=ts_warm_bore.711_1004.gen_250_20000.s1 --expected-lifetime=8h

ts_warm_bore/scripts/list_pnfs_files 711_1004 gen 250_20000 s1 mubeam 12027845 .
ts_warm_bore/scripts/copy_log_files 711_1004 gen 250_20000 s1 s1 12027845 .

cd ts_warm_bore/tmp_fcl/711_1004.s1_mubeam.s2/

tar -cjf ../ts_warm_bore.711_1004.s1_mubeam.s2.tbz *.fcl

ts_warm_bore/scripts/copy_log_files 711_1004 s1 mubeam s2 sim 12036583 .

ts_warm_bore/scripts/list_pnfs_files 711_1004 s1 mubeam s2 mubeam    12036583
ts_warm_bore/scripts/list_pnfs_files 711_1004 s1 mubeam s2 crv       12036583
ts_warm_bore/scripts/list_pnfs_files 711_1004 s1 mubeam s2 truncated 12036583

ts_warm_bore/scripts/gen_fcl 711_1004 s2 mubeam s3 s3
cp ts_warm_bore/tmp_fcl/ts_warm_bore.711_1004.s2_mubeam.s3.tbz /pnfs/mu2e/resilient/users/murat
mu2eprodsys --code=/pnfs/mu2e/resilient/users/murat/ts_warm_bore.code.711_1004.tbz --fcllist=/pnfs/mu2e/resilient/users/murat/ts_warm_bore.711_1004.s2_mubeam.s3.tbz --dsconf=ts_warm_bore_711_1004_s2_mubeam_s3 --wfproject=ts_warm_bore.711_1004.s2_mubeam.s3 --expected-lifetime=8h

ts_warm_bore/scripts/gen_fcl 711_1004 s1 mubeam s1 stn
murat/scripts/submit_mu2e_job -c ts_warm_bore/tmp_fcl/711_1004.s1_mubeam.stn/cnf.murat.ts_warm_bore.711_1004_s1_mubeam.000001_00000000.fcl

ts_warm_bore/scripts/copy_log_files 711_1004 s2 mubeam s3 sim 12042538 .

ts_warm_bore/scripts/gen_fcl 711_1004 s3 ootstops s3 stn .
ts_warm_bore/scripts/gen_fcl 711_1004 s3 tgtstops s3 stn .
ts_warm_bore/scripts/gen_fcl 711_1004 s3 crv s3 stn .
ts_warm_bore/scripts/gen_fcl 711_1004 s3 beam s3 stn .
ts_warm_bore/scripts/gen_fcl 711_1004 s3 truncated s3 stn .

for stream in beam crv ootstops tgtstops truncated ; do 
  murat/scripts/submit_mu2e_job -c ts_warm_bore/tmp_fcl/711_1004.s3_$stream.stn/cnf.murat.ts_warm_bore.711_1004_s3_$stream.000001_00000000.fcl
done

<2018-10-12 Fri>

ts_warm_bore/scripts/gen_fcl 711_1005 gen 250_20000 s1 sim .
ts_warm_bore/scripts/gen_fcl 711_1006 gen 250_20000 s1 sim .
cp ts_warm_bore/tmp_code/ts_warm_bore.code.711_1006.tbz /pnfs/mu2e/resilient/users/murat/.

<2018-10-13 Sat>

mu2eprodsys --code=/pnfs/mu2e/resilient/users/murat/ts_warm_bore.code.711_1006.tbz --fcllist=/pnfs/mu2e/resilient/users/murat/ts_warm_bore.711_1005.gen_250_20000.s1.tbz --dsconf=ts_warm_bore_711_1005_gen_250_20000_s1 --wfproject=ts_warm_bore.711_1005.gen_250_20000.s1 --expected-lifetime=8h

mu2eprodsys --code=/pnfs/mu2e/resilient/users/murat/ts_warm_bore.code.711_1006.tbz --fcllist=/pnfs/mu2e/resilient/users/murat/ts_warm_bore.711_1006.gen_250_20000.s1.tbz --dsconf=ts_warm_bore_711_1006_gen_250_20000_s1 --wfproject=ts_warm_bore.711_1006.gen_250_20000.s1 --expected-lifetime=8h 

ts_warm_bore/scripts/copy_log_files 711_1005 gen 250_20000 s1 sim 12244282 .
ts_warm_bore/scripts/copy_log_files 711_1006 gen 250_20000 s1 sim 12244287 .

ts_warm_bore/scripts/gen_fcl 711_1005 s1 mubeam s2 sim .

<2018-10-14 Sun>

ts_warm_bore/scripts/copy_log_files  711_1006 gen 250_20000 s1 sim    12269299 .
ts_warm_bore/scripts/list_pnfs_files 711_1006 gen 250_20000 s1 mubeam 12269299 .

ts_warm_bore/scripts/copy_log_files 711_1005 s1 mubeam s2 sim 12309121 .
ts_warm_bore/scripts/copy_log_files 711_1006 s1 mubeam s2 sim 12309083 .

ts_warm_bore/scripts/list_pnfs_files 711_1006 s1 mubeam s2 mubeam    12309083 .
ts_warm_bore/scripts/list_pnfs_files 711_1006 s1 mubeam s2 crv       12309083 .
ts_warm_bore/scripts/list_pnfs_files 711_1006 s1 mubeam s2 truncated 12309083 .

